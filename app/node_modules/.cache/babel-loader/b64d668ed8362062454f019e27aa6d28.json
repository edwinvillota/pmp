{"ast":null,"code":"import _defineProperty from \"/home/edwin/Documentos/DEV/webproject/app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/edwin/Documentos/DEV/webproject/app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/edwin/Documentos/DEV/webproject/app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/edwin/Documentos/DEV/webproject/app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/edwin/Documentos/DEV/webproject/app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/edwin/Documentos/DEV/webproject/app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/edwin/Documentos/DEV/webproject/app/src/components/boxstate.js\";\nimport React, { Component } from 'react';\nimport classNames from 'classnames';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\nimport { Typography, Grid, TextField, MenuItem, Button, Table, TableBody, TableCell, TableHead, TableRow, Chip, Avatar } from '@material-ui/core';\n\nvar styles = function styles(theme) {\n  return {\n    root: {\n      display: 'flex',\n      flexWrap: 'wrap'\n    },\n    margin: {\n      margin: theme.spacing.unit\n    },\n    withoutLabel: {\n      marginTop: theme.spacing.unit * 3\n    },\n    textField: {\n      flexBasis: 200,\n      width: '100%'\n    },\n    button: {\n      height: '75%',\n      width: '100%',\n      margin: theme.spacing.unit\n    },\n    table: {\n      minWidth: 700\n    },\n    chip: {\n      margin: theme.spacing.unit,\n      marginLeft: '20px'\n    }\n  };\n};\n\nvar BoxState =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(BoxState, _Component);\n\n  function BoxState() {\n    var _this;\n\n    _classCallCheck(this, BoxState);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(BoxState).call(this));\n\n    _this.handleChange = function (prop) {\n      return function (event) {\n        _this.setState(_defineProperty({}, prop, event.target.value), function () {\n          _this.getInfo();\n        });\n      };\n    };\n\n    _this.getUsers = function () {\n      var fetchConf = {\n        method: 'GET',\n        mode: 'cors'\n      };\n      var colector = _this.state.colector;\n      var url = \"http://localhost:5000/api/dbcsv/getUsers?type=1&number=\".concat(colector);\n      fetch(url, fetchConf).then(function (response) {\n        if (response.ok) {\n          response.json().then(function (json) {\n            _this.setState({\n              users: json\n            }, function () {\n              var _this2 = this;\n\n              json.map(function (u) {\n                _this2.getLec(u['codigo usuario']);\n              });\n            });\n          });\n        }\n      }).catch(function (err) {\n        console.log(err);\n      });\n    };\n\n    _this.getInfo = function () {\n      var _this$state = _this.state,\n          searchType = _this$state.searchType,\n          searchNumber = _this$state.searchNumber;\n      var fetchConf = {\n        method: 'POST',\n        mode: 'cors',\n        body: JSON.stringify({\n          type: searchType,\n          number: searchNumber\n        }),\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      };\n      var url = \"http://localhost:5000/api/dbcsv/getInfo\";\n      fetch(url, fetchConf).then(function (response) {\n        if (response.ok) {\n          response.json().then(function (json) {\n            if (json.concentrador) {\n              _this.setState(json);\n            } else {\n              _this.setState({\n                concentrador: 0,\n                colector: 0,\n                caja: 0\n              });\n            }\n          });\n        }\n      }).catch(function (err) {\n        console.log(err);\n      });\n    };\n\n    _this.getLec = function (user) {\n      if (user) {\n        var users = _this.state.users;\n        var newUsers = [];\n        var fetchConf = {\n          method: 'GET',\n          mode: 'cors'\n        };\n        var url = \"http://localhost:5000/api/dbcsv/getLec?user=\".concat(user);\n        fetch(url, fetchConf).then(function (response) {\n          if (response.ok) {\n            response.json().then(function (json) {\n              if (json.fecha) {\n                newUsers = users.map(function (u) {\n                  if (u['codigo usuario'] === user['codigo usuario']) {\n                    u.fecha = json.fecha;\n                    u.lectura = json.lectura;\n                    u.anomalia = json.anomalia;\n                  }\n                });\n\n                _this.setState({\n                  users: newUsers\n                });\n              }\n            });\n          }\n        });\n      }\n    };\n\n    _this.state = {\n      searchNumber: 0,\n      searchType: 1,\n      users: [],\n      concentrador: 0,\n      colector: 0,\n      caja: 0\n    };\n    return _this;\n  }\n\n  _createClass(BoxState, [{\n    key: \"render\",\n    value: function render() {\n      var classes = this.props.classes;\n      var searchTypes = [{\n        name: 'Colector',\n        value: 1\n      }, {\n        name: 'Caja',\n        value: 2\n      }, {\n        name: 'Usuario',\n        value: 3\n      }, {\n        name: 'Medidor',\n        value: 4\n      }];\n      var users = this.state.users;\n      var _this$state2 = this.state,\n          concentrador = _this$state2.concentrador,\n          colector = _this$state2.colector,\n          caja = _this$state2.caja;\n      return React.createElement(\"div\", {\n        className: \"content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        container: true,\n        spacing: 8,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167\n        },\n        __self: this\n      }, React.createElement(Typography, {\n        variant: \"h4\",\n        component: \"h4\",\n        align: \"center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, \"Verificaci\\xF3n de Cajas\")), React.createElement(Grid, {\n        item: true,\n        xs: 5,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        select: true,\n        label: \"Buscar por:\",\n        className: classNames(classes.margin, classes.textField),\n        value: this.state.searchType,\n        onChange: this.handleChange('searchType'),\n        variant: \"outlined\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }, searchTypes.map(function (option) {\n        return React.createElement(MenuItem, {\n          key: option.value,\n          value: option.value,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 182\n          },\n          __self: this\n        }, option.name);\n      }))), React.createElement(Grid, {\n        item: true,\n        xs: 5,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        label: \"C\\xF3digo\",\n        className: classNames(classes.margin, classes.textField),\n        variant: \"outlined\",\n        onChange: this.handleChange('searchNumber'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      })), React.createElement(Grid, {\n        item: true,\n        xs: 2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, React.createElement(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        className: classes.button,\n        onClick: this.getUsers,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }, \"BUSCAR\"))), React.createElement(Grid, {\n        container: true,\n        spacing: 24,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      }, React.createElement(Chip, {\n        avatar: React.createElement(Avatar, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 212\n          },\n          __self: this\n        }, \"CC\"),\n        label: concentrador,\n        className: classes.chip,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211\n        },\n        __self: this\n      }), React.createElement(Chip, {\n        avatar: React.createElement(Avatar, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 217\n          },\n          __self: this\n        }, \"CL\"),\n        label: colector,\n        className: classes.chip,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }), React.createElement(Chip, {\n        avatar: React.createElement(Avatar, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 222\n          },\n          __self: this\n        }, \"CJ\"),\n        label: caja,\n        className: classes.chip,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      }), React.createElement(Chip, {\n        avatar: React.createElement(Avatar, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 227\n          },\n          __self: this\n        }, \"U\"),\n        label: users.length,\n        className: classes.chip,\n        color: \"primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      })), React.createElement(Grid, {\n        container: true,\n        spacing: 24,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233\n        },\n        __self: this\n      }, React.createElement(Table, {\n        className: classes.table,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }, React.createElement(TableHead, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }, React.createElement(TableRow, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      }, React.createElement(TableCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237\n        },\n        __self: this\n      }, \"Codigo\"), React.createElement(TableCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        },\n        __self: this\n      }, \"Tipo\"), React.createElement(TableCell, {\n        numeric: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239\n        },\n        __self: this\n      }, \"Medidor\"), React.createElement(TableCell, {\n        numeric: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240\n        },\n        __self: this\n      }, \"Homedisplay\"), React.createElement(TableCell, {\n        numeric: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      }, \"Fecha\"), React.createElement(TableCell, {\n        numeric: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242\n        },\n        __self: this\n      }, \"Lectura\"), React.createElement(TableCell, {\n        numeric: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243\n        },\n        __self: this\n      }, \"Anomalia\"))), React.createElement(TableBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      }, users.map(function (row) {\n        return React.createElement(TableRow, {\n          key: row['codigo usuario'],\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 249\n          },\n          __self: this\n        }, React.createElement(TableCell, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 250\n          },\n          __self: this\n        }, row['codigo usuario']), React.createElement(TableCell, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 253\n          },\n          __self: this\n        }, row['tipousuario']), React.createElement(TableCell, {\n          numeric: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 254\n          },\n          __self: this\n        }, row['codigo de medidor']), React.createElement(TableCell, {\n          numeric: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 255\n          },\n          __self: this\n        }, row.display));\n      })))));\n    }\n  }]);\n\n  return BoxState;\n}(Component);\n\nBoxState.propTypes = {\n  classes: PropTypes.object.isRequired\n};\nexport default withStyles(styles)(BoxState);","map":{"version":3,"sources":["/home/edwin/Documentos/DEV/webproject/app/src/components/boxstate.js"],"names":["React","Component","classNames","PropTypes","withStyles","Typography","Grid","TextField","MenuItem","Button","Table","TableBody","TableCell","TableHead","TableRow","Chip","Avatar","styles","theme","root","display","flexWrap","margin","spacing","unit","withoutLabel","marginTop","textField","flexBasis","width","button","height","table","minWidth","chip","marginLeft","BoxState","handleChange","prop","event","setState","target","value","getInfo","getUsers","fetchConf","method","mode","colector","state","url","fetch","then","response","ok","json","users","map","u","getLec","catch","err","console","log","searchType","searchNumber","body","JSON","stringify","type","number","headers","concentrador","caja","user","newUsers","fecha","lectura","anomalia","classes","props","searchTypes","name","option","length","row","propTypes","object","isRequired"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport { withStyles } from '@material-ui/core/styles'\nimport {\n  Typography,\n  Grid,\n  TextField,\n  MenuItem,\n  Button,\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n  Chip,\n  Avatar\n } from '@material-ui/core'\n\n const styles = theme => ({\n  root: {\n    display: 'flex',\n    flexWrap: 'wrap',\n  },\n  margin: {\n    margin: theme.spacing.unit,\n  },\n  withoutLabel: {\n    marginTop: theme.spacing.unit * 3,\n  },\n  textField: {\n    flexBasis: 200,\n    width: '100%',\n  },\n  button: {\n    height: '75%',\n    width: '100%',\n    margin: theme.spacing.unit,\n  },\n  table: {\n    minWidth: 700,\n  },\n  chip: {\n    margin: theme.spacing.unit,\n    marginLeft: '20px'\n  },\n});\n\nclass BoxState extends Component {\n  constructor() {\n    super()\n    this.state = {\n      searchNumber : 0,\n      searchType: 1,\n      users: [],\n      concentrador: 0,\n      colector: 0,\n      caja: 0\n    }\n  }\n\n  handleChange = prop => event => {\n    this.setState({ [prop]: event.target.value }, () => { this.getInfo() })\n  }\n\n  getUsers = () => {\n    let fetchConf = {\n      method: 'GET',\n      mode: 'cors'\n    }\n    const {colector} = this.state\n\n    let url = `http://localhost:5000/api/dbcsv/getUsers?type=1&number=${colector}`\n    fetch(url, fetchConf)\n      .then(response => {\n        if(response.ok) {\n          response.json().then(json => {\n            this.setState({users: json}, function(){\n              json.map(u => {\n                this.getLec(u['codigo usuario'])\n              })\n            })\n          })\n        }\n      })\n      .catch(function(err) {\n        console.log(err)\n      })\n  }\n\n  getInfo = () => {\n    const {searchType, searchNumber} = this.state\n\n    let fetchConf = {\n      method: 'POST',\n      mode: 'cors',\n      body: JSON.stringify({type: searchType, number: searchNumber}),\n      headers: {\n        'Content-Type' : 'application/json'\n      }\n    }\n\n    let url = `http://localhost:5000/api/dbcsv/getInfo`\n    fetch(url, fetchConf)\n      .then(response => {\n        if(response.ok) {\n          response.json().then(json => {\n            if(json.concentrador) {\n              this.setState(json)\n            } else {\n              this.setState({\n                concentrador: 0,\n                colector: 0,\n                caja: 0\n              })\n            }\n          })\n        }\n      }).catch(function(err){\n        console.log(err)\n      })\n  }\n\n  getLec = (user) => {\n    if (user) {\n      let users = this.state.users\n      let newUsers = []\n      let fetchConf = {\n        method: 'GET',\n        mode: 'cors',\n      }\n      let url = `http://localhost:5000/api/dbcsv/getLec?user=${user}`\n      fetch(url, fetchConf)\n        .then(response => {\n          if(response.ok) {\n            response.json().then(json => {\n              if(json.fecha){\n                newUsers = users.map(u => {\n                  if(u['codigo usuario'] === user['codigo usuario']){\n                    u.fecha = json.fecha\n                    u.lectura = json.lectura\n                    u.anomalia = json.anomalia\n                  }\n                })\n                this.setState({users: newUsers})\n              }\n            })\n          }\n        })\n    }\n  }\n\n  render() {\n    const { classes } = this.props\n    const searchTypes = [\n            {name: 'Colector', value: 1},\n            {name: 'Caja', value: 2},\n            {name: 'Usuario', value: 3},\n            {name: 'Medidor', value: 4}\n          ]\n    const users = this.state.users\n    let { concentrador, colector, caja } = this.state\n\n    return(\n      <div className='content'>\n        <Grid container spacing={8}>\n          <Grid item xs={12}>\n            <Typography variant=\"h4\" component=\"h4\" align='center'>\n              Verificación de Cajas\n            </Typography>\n          </Grid>\n          <Grid item xs={5}>\n            <TextField\n              select\n              label=\"Buscar por:\"\n              className={classNames(classes.margin, classes.textField)}\n              value={this.state.searchType}\n              onChange={this.handleChange('searchType')}\n              variant=\"outlined\"\n            >\n              {searchTypes.map(option => (\n                <MenuItem key={option.value} value={option.value}>\n                  {option.name}\n                </MenuItem>\n              ))}\n            </TextField>\n          </Grid>\n          <Grid item xs={5}>\n            <TextField\n              label=\"Código\"\n              className={classNames(classes.margin, classes.textField)}\n              variant=\"outlined\"\n              onChange={this.handleChange('searchNumber')}\n            />\n          </Grid>\n          <Grid item xs={2}>\n            <Button\n              variant=\"contained\"\n              color=\"primary\"\n              className={classes.button}\n              onClick={this.getUsers}\n              >\n              BUSCAR\n            </Button>\n          </Grid>\n        </Grid>\n        <Grid\n          container\n          spacing={24}\n          >\n            <Chip\n              avatar={<Avatar>CC</Avatar>}\n              label={concentrador}\n              className={classes.chip}\n            />\n            <Chip\n              avatar={<Avatar>CL</Avatar>}\n              label={colector}\n              className={classes.chip}\n            />\n            <Chip\n              avatar={<Avatar>CJ</Avatar>}\n              label={caja}\n              className={classes.chip}\n            />\n            <Chip\n              avatar={<Avatar>U</Avatar>}\n              label={users.length}\n              className={classes.chip}\n              color=\"primary\"\n            />\n        </Grid>\n        <Grid container spacing={24}>\n          <Table className={classes.table}>\n            <TableHead>\n              <TableRow>\n                <TableCell>Codigo</TableCell>\n                <TableCell>Tipo</TableCell>\n                <TableCell numeric>Medidor</TableCell>\n                <TableCell numeric>Homedisplay</TableCell>\n                <TableCell numeric>Fecha</TableCell>\n                <TableCell numeric>Lectura</TableCell>\n                <TableCell numeric>Anomalia</TableCell>\n              </TableRow>\n            </TableHead>\n            <TableBody>\n              {users.map(row => {\n                return (\n                  <TableRow key={row['codigo usuario']}>\n                    <TableCell>\n                      {row['codigo usuario']}\n                    </TableCell>\n                    <TableCell >{row['tipousuario']}</TableCell>\n                    <TableCell numeric>{row['codigo de medidor']}</TableCell>\n                    <TableCell numeric>{row.display}</TableCell>\n                  </TableRow>\n                );\n              })}\n            </TableBody>\n          </Table>\n        </Grid>\n      </div>\n    )\n  }\n}\n\nBoxState.propTypes = {\n  classes: PropTypes.object.isRequired,\n}\n\nexport default withStyles(styles)(BoxState)\n"]},"metadata":{},"sourceType":"module"}